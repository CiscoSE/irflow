{% extends 'base_layout.html' %}
{% set active_sidebar = "threats" %}

{% block mainpanel %}

<br>

<div class="col-md-6">
      <div class="ui-steps ui-steps--vertical">
            <div class="ui-step active">
                <div class="step__icon">3</div>
                <div class="step__label">Find Malware Samples (Threat Grid)</div>
            </div>
            <div class="ui-step active">
                <div class="step__icon">4</div>
                <div class="step__label">Collect and Analyse Suspect Domains (Investigate)</div>
            </div>
      </div>
</div>

<hr>


{% for item in domain %}

<div class="row no-gutters">
    <div class="col-md-4">
        <div class="hero hero--ltgray">
            <span class="text-uppercase">{{item['domain']}}</span>
        </div>
    </div>
</div>

<b> Content Categories: </b>
<br />
{% for item in item['content_cat'] %}
{{item}}
{% endfor %}

<br />
<br />
<b> Security Categories: </b>
<br />
{% for item in item['security_cat'] %}
{{item}}
{% endfor %}

<div class="container">
  <div style="padding-top: 20px">
    <div class="responsive-table table--wrap">
      <table id="threat-datatable" class="table table--bordered" word-wrap:break-word;>
          <thead>
              <tr>
                  <th></th>
                  <th>Description</th>
                  <th>Value</th>
                  <th>Suspicious</th>
              </tr>
          </thead>
          <tbody>
        <tr>
          <td>Domain Score</td>
          <td>Domain Score Description</td>
          <td>{{item['domain_score']}}</td>
        </tr>
        <tr>
          <td>DGA Score</td>
          <td>Domain Generation Algorithm. This score is generated based on the likeliness of the domain name being generated by an algorithm rather than a human. This algorithm is designed to identify domains which have been created using an automated randomization strategy, which is a common evasion technique in malware kits or botnets. 

          This score ranges from -100 (suspicious) to 0 (benign).</td>
          <td>{{item['dga_score']}}</td>
        </tr>
        <tr>
          <td>Perplexity</td>
          <td>A second score on the likeliness of the name to be algorithmically generated, on a scale from 0 to 1. This score is to be used in conjunction with DGA.</td>
          <td>{{item['perplexity']}}</td>
        </tr>
        <tr>
          <td>Secure Rank</td>
          <td>Suspicious rank for a domain that reviews based on the lookup behavior of client IP for the domain. Securerank is designed to identify hostnames requested by known infected clients but never requested by clean clients, assuming these domains are more likely to be bad. 

          Scores returned range from -100 (suspicious) to 100 (benign).</td>
          <td>{{item['securerank2']}}</td>
        </tr>    
        <tr>
          <td>Page Rank</td>
          <td>Popularity according to Google's pagerank algorithm</td>
          <td>{{item['pagerank']}}</td>
        </tr>
        <tr>
          <td>ASN Reputation</td>
          <td>ASN reputation score, ranges from -100 to 0 with -100 being very suspicious.</td>
          <td>{{item['asn_score']}}</td>
        </tr>
        <tr>
          <td>Prefix Score</td>
          <td>Prefix ranks domains given their IP prefixes (an IP prefix is the first three octets in an IP address) and the reputation score of these prefixes. 

          Ranges from -100 to 0, -100 being very suspicious.</td>
          <td>{{item['prefix_score']}}</td>
        </tr>   
        <tr>
          <td>RIP Score</td>
          <td>RIP ranks domains given their IP addresses and the reputation score of these IP addresses. 

          Ranges from -100 to 0, -100 being very suspicious.</td>
          <td>{{item['rip_score']}}</td>
        </tr> 
        <tr>
          <td>Known Attacks</td>
          <td>The name of any known attacks associated with this domain. None if no value is displayed.</td>
          <td>{{item['attack']}}</td>
        </tr>
        <tr>
          <td>Known Threats</td>
          <td>The type of the known attack, such as botnet or APT. None if no known threat associated with domain</td>
          <td>{{item['threat_type']}}</td>
        </tr>
        <tr>
          <td>Threats Associated</td>
          <td>Displays true if this domain has been associated with known threats. None if no known threat associated with this domain.
          <td>{{item['found']}}</td>
        </tr>             
      </tbody>
      </table>
    </div>
  </div>
</div>

{% endfor %}

{% endblock %}

<!-- disable footer for this page  -->
{% block footer %}{% endblock %}
